function [pred_labels, distances, X, Y, AUC]  = loop_test_data(train_name, test_name, gen_auc)

    %structure-only - requires change of boxconstraint and rbfsigma -
    %mostly cleaved
    %formatSpec = '%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%f32,%f32,%f32,%f32,%*s';
    %sequence-only - mostly cleaved
    %formatSpec = '%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%*f32,%*f32,%*f32,%*f32,%*s';

    formatSpec = '%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%*s';
    formatSpecString = '%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%s';
    formatSpecStruct = '%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%f32,%f32,%f32,%f32,%*s';
    formatSpecStringStruct = '%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%s';
    formatSpecSeq = '%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%*f32,%*f32,%*f32,%*f32,%*s';
    formatSpecStringSeq = '%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%s';

    train_file = fopen(train_name);
    train_data_raw = textscan(train_file, formatSpec);
    fclose(train_file);

    train_file = fopen(train_name);
    train_labels_raw = textscan(train_file, formatSpecString);

    train_labels = train_labels_raw{1,1};
    train_data = cell2mat(train_data_raw);

    svmrbf=svmtrain(train_data, train_labels, 'kernel_function', 'rbf', 'boxconstraint', 1, 'rbf_sigma', 10);
    test_file = fopen(test_name);

    formatSpecTest = '%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32';
    formatSpecTestStruct = '%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%f32,%f32,%f32,%f32';
    formatSpecTestSeq = '%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%*f32,%*f32,%*f32,%*f32';
    
    %sequence-only - mostly cleaved
    %formatSpecTest = '%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%f32,%*f32,%*f32,%*f32,%*f32';

    %structure-only - requires change of boxconstraint and rbfsigma -
    %mostly cleaved
    %formatSpecTest = '%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%*f32,%f32,%f32,%f32,%f32';

    [status, n_l_s] = system(['wc -l ' test_name ' | awk ''{print $1}''']);
    n_lines = str2double(n_l_s);
    disp(n_l_s);
    
    pred_labels = cell(n_lines,1);
    distances = zeros(n_lines,1);
    
    X = 0;
    Y = 0;
    AUC = 0;
    
    if n_lines < 32000
        test_data_raw = textscan(test_file, formatSpec);
        test_data = cell2mat(test_data_raw);  
        [pred_labels, distances] = main_svm(svmrbf, test_data);

        if gen_auc == 1
            fclose(test_file);

            test_file = fopen(test_name);
            test_labels_raw = textscan(test_file, formatSpecString);

            test_labels = test_labels_raw{1,1};
            [X, Y, T, AUC] = perfcurve(test_labels, distances, 'CLEAVED');
            %[X, Y, T, AUC] = perfcurve(test_labels, distances, 'CLEAVED', 'xCrit', 'reca', 'yCrit', 'prec');
        end
    else
        for i = 0:99
            test_data_raw = textscan(test_file, formatSpecTest, 32000);
            test_data = cell2mat(test_data_raw);

            start_ind = i*32000+1;
            end_ind = (i+1)*32000;
            [l, d] = main_svm(svmrbf, test_data);
            pred_labels(start_ind:end_ind) = l;
            distances(start_ind:end_ind) = d;

        end
    end    
    fclose(test_file);